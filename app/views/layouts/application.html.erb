<!DOCTYPE html>
<html>
  <head>
    <title>Varacia</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= stylesheet_link_tag "application", media: 'all', "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>
    <%= yield :head %>
  </head>

  <body <%= content_for?(:body_class) ? "class=#{yield(:body_class)}" : '' %>>
    <nav class="navbar">
      <h1><%= link_to "Varacia", root_path %></h1>
      <div class="subnavbar">

        <div class="submenu">
          <a href="/reglas" class="nblink">Información</a>
          <div class="submenu-content">
              <a href="/reglas">Reglas</a>
              <a href="/estadosAlterados">Estados Alterados</a>
              <%= link_to "Historias y trasfondo", main_cuento_path%>
          </div>
        </div>

        <div class="submenu">
          <%= link_to "Clases y habilidades", clases_path, class:"nblink" %>
          <div class="submenu-content">
            <%= link_to "Todas las clases", clases_path, class:"mainLink" %>
            <%= link_to "Todas las habilidades", habilidads_path, class:"mainLink" %>
            <%= link_to "Árbol de clases", "/clases-arbol", class:"mainLink" %>
            <%= link_to "Clases radicales", clases_path(mode:"radical"), class:"mainLink" %>
            <%= link_to "Razas", clases_path(mode:"raza"), class:"mainLink" %>
            <% navbar_cache_clases_ocultas.each do |clase| %>
                <%= link_to clase.nombre, clase, class:"mainLink"  %>
            <% end %>
            <% navbar_cache_clases_visibles.each do |clase| %>
                <%= link_to clase.nombre, clase %>
            <% end %>
          </div>
        </div>

        <div class="submenu">
          <%= link_to "Items", items_path, class:"nblink" %>
          <div class="submenu-content">
            <%= link_to "Todos los items", items_path, class:"mainLink" %>
            <%= link_to "Cofre aleatorio", "/lootbox", class:"mainLink" %>
            <% navbar_cache_categorias.each do |ct| %>
                <%= link_to ct.nombre, ct %>
            <% end %>
          </div>
        </div>
        
        <div class="submenu">
          <%= link_to "Galería", pictures_path, class:"nblink nblink_notSubMenu" %>
        </div>

        <% only_admin_content do %>
          <div class="submenu">
            <a href="/control" class="nblink">Admin</a>
            <div class="submenu-content">
              <%= link_to "Panel de control", "/control" %>
              <%= link_to "Habilidades ocultas", "/habilidads_ocultas"%>
              <%= link_to "Habilidades sueltas", "/habilidads_sueltas"%>
              <%= link_to "Ítems sin categoría", "/items_no_categ"%>
              <%= link_to "Mobs", mobs_path %>
              <%= link_to "Crear mob", new_mob_path %>
              <%= link_to "Crear clase", new_clase_path %>
              <%= link_to "Crear habilidad", new_habilidad_path %>
              <%= link_to "Crear item", new_item_path %>
              <%= link_to "Crear categoría", new_categ_path %>
              <%= link_to "Crear cuadro", new_picture_path %>
              <%= link_to "Crear etiqueta", new_etiquet_path %>
              <%= link_to "Crear cuento", new_cuento_path %>
            </div>
          </div>
        <% end %>

        <%= image_tag "scroll.png", class:"subnavbar-scroll_indicator"%>
      </div>
    </nav>

    <% # Divs para mostrar mensajes y alerta del sistema relacionados con el resutado de procesos %>
    <% if notice || alert %>
      <div class="flash-wrapper">
        <% if notice %>
          <div class="flash-notice">
            <span class="flash-close" onclick="this.parentElement.remove()">✕</span>
            <%= notice %>
          </div>
        <% end %>
        <% if alert %>
          <div class="flash-alert">
            <span class="flash-close" onclick="this.parentElement.remove()">✕</span>
            <%= alert %>
          </div>
        <% end %>
      </div>
    <% end %>


    <div class="main-content">
      <%= yield %>
    </div>

    
    <footer class="footbar">
      <%= link_to "Aviso legal", "/avisolegal"%>
      <%= not_admin_content do%>
        <br>
        <%= link_to "Admin access", "/control" %>
      <% end %>
    </footer>

  </body>
</html>
